class t extends HTMLElement{static QN="tipps-visor";static QR=Object.freeze([t]);Pursue=!0;Margin=4;#t;#e;#i="";#s=null;#n;#o;get#r(){return this.firstElementChild?.classList??null}constructor(){super();let t=this.attachShadow({mode:"closed"}),e=t.ownerDocument,i=this.#t=t.appendChild(e.createElement("div"));i.style.position="absolute",i.style.pointerEvents="none",this.#e=i.appendChild(e.createElement("slot"))}updateIndicator(t){const e=this.#r;e?.contains(this.#i)&&(e.remove(this.#i),e.add(t)),this.#i=t}#a(t=null){(this.querySelector("slot[name=prompt]")??this.#e).innerText=t??""}#h(t,e){const i=this.#t.style;i.left=t+"px",i.top=e+"px"}#l=t=>{const e=this.#s?.ownerDocument?.defaultView;if(!e)return;const i=this.#t.getBoundingClientRect(),s=new DOMRect(t.pageX,t.pageY,18,18),n=function(t,e){const i=2*e;return new DOMRect(t.scrollX+e,t.scrollY+e,t.innerWidth-i,t.innerHeight-i)}(e,this.Margin);let o=new DOMPoint(s.x,s.y-i.height),r=new DOMPoint(Math.max(0,n.left-o.x)+Math.min(0,n.right-(o.x+i.width)),Math.max(0,n.top-o.y)+Math.min(0,n.bottom-o.y));o.x+=r.x?r.x:s.width*(r.y/i.height),o.y+=r.y,o.x=Math.min(o.x,n.right-i.width),o.y=Math.min(o.y,n.bottom-i.height),this.#h(o.x,o.y)};#u(t,e,i){if(this.#n=void 0,this.#r?.add(this.#i),this.#t.style.zIndex=i.style.zIndex??"0",this.#a(i.getAttribute(t.Source)),this.Pursue)this.#l(e),i.ownerDocument.addEventListener("mousemove",this.#l);else{const t=i.getBoundingClientRect();this.#h(t.right-this.Margin,t.bottom-this.Margin)}}onTippsUp(t,e){const i=e.target;i instanceof HTMLElement&&(this.#o?(this.#o=clearTimeout(this.#o),this.#u(t,e,this.#s=i)):(this.#s=i,this.#n=setTimeout((()=>this.#u(t,e,i)),t.Delay)))}#d(){this.#o=void 0,this.#a(),this.#t.style.zIndex="-1",this.#r?.remove(this.#i)}onTippsDown(t,e){this.#n=clearTimeout(this.#n),this.#o=clearTimeout(this.#o),this.#s?.ownerDocument.removeEventListener("mousemove",this.#l),"click"===e.type||"mousedown"===e.type?this.#d():this.#o=setTimeout((()=>this.#d()),t.Loiter),this.#s=null}}const e="target",i="indicator",s="source",n="pursue",o="margin",r="delay",a="loiter";class h extends HTMLElement{static QN="tipps";static QR=Object.freeze([...t.QR,h]);static observedAttributes=Object.freeze([e,i,s,n,o,r,a]);#c=new t;#p=new MutationObserver(((t,e)=>{let i=this.#m;for(const e of t)"childList"===e.type?(e.removedNodes.forEach((t=>this.#g(t,i,!0))),e.addedNodes.forEach((t=>this.#g(t,i)))):"attributes"===e.type&&(this.#g(e.target,i,!0),this.#g(e.target,i))}));#v=t=>this.#c.onTippsUp(this,t);#E=t=>this.#c.onTippsDown(this,t);#g(t,e,i=!1){if(t instanceof HTMLElement&&t.matches(e)){const e=i?t.removeEventListener:t.addEventListener;e.bind(t)("mouseover",this.#v),e.bind(t)("mouseout",this.#E),e.bind(t)("mousedown",this.#E),e.bind(t)("click",this.#E)}}get#m(){return this.getAttribute(e)??"[title]"}get#i(){return this.getAttribute(i)??"active"}get Source(){return this.getAttribute(s)??"title"}get#b(){if(!this.hasAttribute(n))return!1;const t=this.getAttribute(n);return!t||!/^\s*(false|0|off)\s*$/i.test(t)}get#y(){return Number(this.getAttribute(o)??4)}get Delay(){return Number(this.getAttribute(r)??700)}get Loiter(){return Number(this.getAttribute(a)??300)}connectedCallback(){const t=this.parentNode;if(t){const e=this.#m,i=t.querySelectorAll(e);for(const t of i)this.#g(t,e,!0),this.#g(t,e);this.#p.disconnect(),this.#p.observe(t,{childList:!0,subtree:!0,characterData:!1}),this.#c.append(...this.children),t.appendChild(this.#c),this.#c.Pursue=this.#b,this.#c.updateIndicator(this.#i)}}attributeChangedCallback(t,s,r){switch(t){case e:return this.connectedCallback();case n:return void(this.#c.Pursue=this.#b);case i:return void this.#c.updateIndicator(this.#i);case o:return void(this.#c.Margin=this.#y)}}}[...h.QR].forEach((t=>customElements.define(`wb-${t.QN}`,t)));
